# various game hacks

In this folder I'm collecting small hacks I did for various games. (not everything is ADV/VN)

**Note:** In most cases, file names and strings are terminated using a `00` byte. Keep in mind to append a `00` byte especially after file names.

- Escalation '95 \~Onee-sama tte Yonde Ii Desu ka?\~
  - jump to ending from main menu
    - in `start.mdr` (decrypt by XORing with 0FFh)
      - search for `=esop.mdr` (should be at the end of the file)
      - overwrite it with `=end.mdr` + a 00 byte
      - then re-encrypt the file
    - select "start from beginning" in the main menu
    - You can also do the search/replace process in the PC-98 emulator's RAM directly while in the main menu. In this case, no decryption is necessary.
  - Note: The game seems a bit buggy and corrupts the main save file after the staff roll finishes the 2nd time, making the game crash while loading the main menu.
- Frontier
  - jump to ending from main menu
    - Notes:
      - The actions are to be performed by editing the PC-98 emulator RAM while at a certain location. The script files (`.SO3`) are compressed, so editing them directly is harder.
      - Playing through the intro dialogue ensures that special characters and portraits are loaded properly and show up during the Ending scenes.
    - 遠雷ワイバーン
      - variant 1: while at the menu selection screen (file `A0_002.SO3`), search for `A:\WB_000.SO3` and overwrite it with `A:\WB_END0.SO3` + a `00` byte  
        This will jump directly to the credits screen after confirming the character name.
      - variant 2: while viewing the first dialogue line (file `WB_001.SO3`), search for `b:\wb_002.so3` (must be lower case) and overwrite it with `b:\wb_013.so3`
        After the 9th intro dialogue, it will jump to the Epilogue.
    - 快感空間「愛」
      - variant 1: while at the menu selection screen (file `A0_002.SO3`), search for `A:\KI_000.SO3` and overwrite it with `A:\KI_END1.SO3` + a `00` byte  
        This will jump directly to the credits screen after confirming the character names.
      - variant 2: while viewing the first dialogue line (file `WB_001.SO3`), search for `B:\KI_002.SO3` and overwrite it with `B:\KI_END0.SO3` + a `00` byte  
        After many dialogue lines, it will jump to the Ending.
    - Ｂｌｏｏｄ　ｌｉｎｅ
      - variant 1: while at the menu selection screen (file `A0_002.SO3`), search for `A:\BL_000.SO3` and overwrite it with `A:\BL_END.SO3`
        This will jump to the credits screen directly.
      - variant 2: while viewing the first dialogue line (file `BL_001.SO3`), search for `b:\bl_002.so3` and overwrite it with `b:\bl_015.so3`
        After many dialogue lines, it will jump to one of the endings (NSFW!).
- Frontier Universe
  - enable / disable user manual protection screen:
    - In `FRONT.EXE`, search for `B8 70 02 8E D8 90`. (EXE offset 0x84FF6) After this sequence, check/modify the following 4 bytes:
      - the original, uncracked EXE has `0E E8 12 00`, which will load + show the "user manual protection" screen
      - the cracked EXE has `30 C0 EB 05`, which will cause the screen to be skipped and simulate a "success" return code
  - trigger "time over / game over" screen
    - In `FRONT.EXE`, search for `26 81 3E 7A DF 50 C3`. (EXE offset 0x02951) This instruction checks for the timeout to be reached.
    - Change the byte after this sequence from `75` ("JEQ") to `74` ("JNE").
    - Then start a new game and let the clock run for one year.
  - jump to "congratulations" screen
    - In `FRONT.EXE`, search for `8B F0 0B F6 74 07`. (EXE offset 0x293F)
    - Change the byte `74` ("JE") to `75` ("JNE") to enforce the "congratulations" screen being called in any case.
    - Then start a new game and let the clock run for one year.
    - alternate patch (seems to work only with Scenario 1):
      - In `FRONT.EXE`, search for `3B 46 FC 73 05 B8 01 00 EB 02`. (EXE offset 0x02CB4) This is inside the function that checks for the winning condition.
      - Change the bytes after this sequence from `33 C0` ("XOR AX, AX") to `EB F9` ("JMP $-5", jumps to "MOV AX, 1").
  - jump to staff roll
    - In `FRONT.EXE`, search for `8B F0 0B F6 74 07`. (EXE offset 0x293F)
    - Change the byte `74` ("JE") to `75` ("JNE").
    - Search for `9A 3E 00 32 28`. (EXE offset 0x02946, CALL ShowCongrats)
    - Change these bytes to `9A 5C 00 37 28` (CALL ShowCredits)
    - Then start a new game and let the clock run for one year.
    - NOTE: The staff roll code seems to be unreferenced and partially broken.
- Gaogao 1/2
  - jump to an arbitrary chapter:
    - while on the main menu, search for `18 00 61 01 01 00 18 00 62 01 00 00`
    - repalce the number after `61 01` with the chapter ID (01..09) and the number after `62 01` with the scene ID
    - The last chapter has ID 09.
- Gaogao 3: Wild Force
  - jump to an arbitrary chapter:
    - while on the main menu, search for `25 0B 04 00 09 00 18 00 2D 01 00` and repalce the last `00` with any number from 00 to 09
    - then select the first menu entry ("start from beginning")
    - Note 1: Chapter 1 will show the game's main title.
    - Note 2: `2D 01` specifies the register number 301, which contains the chapter ID. Register 302 contains the scene ID.
  - jump to final scene:
    - while on the main menu, search for `25 0B 04 00 09 00 18 00 2D 01 00 00 18 00 2E 01 00`
    - replace `2D 01 00` with `2D 01 09` (chapter = 9) and replace `2D 01 00` with `2E 01 02` (scene = 2)
    - (For some reason, the scenes are ordered 8 -> 2 -> end)
    - then select the first menu entry ("start from beginning")
- Gaogao 4 Canaan
  - jump to a certain chapter from main menu
    - While on the main menu, search for `prolog.s` and overwrite it with `csXX_YY.s` + a `00` byte. (XX = 2-digit chapter ID, YY = 2-digit scene ID) Then choose "Start Opening".
    - Alternatively search for `CS01_01.s` and overwrite it with `csXX_YY.s`. Then choose "Start Main Story".
    - The difference between the two is, that the "Opening" version can show the chapter intro screen while the "Main Story" entry won't show it.
  - jump to ending from main menu
    - While on the main menu, search for `prolog.s` and overwrite it with `ending.s`. Then choose "Start Opening".
  - hacking info:
    - register 185 contains the chapter ID (1..28)
    - register 186 contains the scene ID (1+, range depends on chapter)
    - The ending is chapter 28, scene 7.
- Irium
  - jump to ending from main menu
    - while on the main menu (NOT in a sub-menu like music mode), search for `A:\IRMEMO.SCC` and overwrite it with `A:\B_BOSSB.SCC` + a `00` byte
    - then select the last entry in the menu
    - During the ending screen, choose the option in the centre to progress.
    - Note 1: The script file for the main menu is called `IR01.SCC`. But it is LZSS-compressed, so it can't be edited directly.
    - Note 2: When jumping to the ending directly, some graphics are garbled. In order to avoid this, load the first scene and patch `A:\IR03.SCC` to `A:\B_BOSSB.SCC` + a `00` byte
- Kurayami
  - jump to ending from title screen
    - in `start.mdr` (decrypt by XORing with 0FFh)
      - search for `=start2.mdr` (should be at the end of the file)
      - overwrite it with `=end_a1.mdr` (possible endings are: `a1`, `a2`, `a3`, `b1`, `b2`, `b3`, `c1`, `c2`, `c3`)
      - then re-encrypt the file
    - the ending will be shown right after the title screen
    - You can also do the search/replace process in the PC-98 emulator's RAM directly while on the title screen. In this case, no decryption is necessary.
  - jump to ending from main menu
    - in `start2.mdr` (extract from *MDR.PCK* and decrypt by XORing with 0FFh)
      - search for `=YM001.mdr`
      - overwrite it with `=end_a1.mdr` + a 00 byte
      - then re-encrypt the file
    - select "start from beginning" in the main menu
    - You can also do the search/replace process in the PC-98 emulator's RAM directly while in the main menu. In this case, no decryption is necessary.
- Lilith
  - jump to ending after first scene
    - in `l0_00.s` (extract from *DISK_B.LIB* and decrypt by XORing with 01h)
      - search for `L0_01.s` (Note: must be just after a `02` byte)
      - overwrite it with `lg_00.s`
      - then re-encrypt the file
    - select "start from beginning" in the main menu, then progress until you find a cat
    - You can also do the search/replace process in the PC-98 emulator's RAM directly while in the respective scene is playing. In this case, no decryption is necessary.
    - Note: Trying to jump there from the main menu will prevent the border from loading properly.
  - jump to final battle from title screen
    - in `lilith.s` (extract from *DISK_A.LIB* and decrypt by XORing with 01h)
      - search for `L0_00.s` (Note: must be just after a `02` byte)
      - overwrite it with `lf_02.s`
      - then re-encrypt the file
    - select "start from beginning" in the main menu
    - You can also do the search/replace process in the PC-98 emulator's RAM directly while in the main menu. In this case, no decryption is necessary.
  - In decrypted scripts, the following byte sequence is used to play a song:
    - `1800 2002 nnnn  5400 2041` where `nnnn` is the song ID
    - for searching in encrypted files, XOR all bytes with 01h
- Mahjong Fantasia the 3rd Stage
  - save game editing:
    - The save file files are called `MG3STMD#.SAV`. (`1..4` = save 1..4, `L` = last auto-save)
    - At the bottom of the file, there is the file name of the current scenario, e.g. `C:MF3_01.hgo`.
      You can set it to `C:MF3_25.hgo` to reach the last scenario.
    - `MG3STMD4.SAV` is a save game right at the ending scene.
  - Scenario file editing:
    - The game stores the files compressed. You will need to perform edits in the PC-98 emulator's RAM while the respective file is loaded.
    - Skip final boss: Seach for `@MENBER_1` until you find it in the middle of lots of Shift-JIS encoded text. (There is `@A:WAKU` slightly below.)
      There it prepares loading the final boss match.  
      From there, search for `0B 8B 0B 80 0B 05 01` and replace it with `04 53 6B 69 70 5C 50`. (`04` introduces a text block.)
- Merry Go Round
  - replace opening scene with ending/staff roll
    - in `DISK1.NDX` replace `OPENING.OVL` with `#PENING.OVL`
    - then overwrite `ENDING.OVL` with `OPENING.OVL`
    - alternative: overwrite with `S11_9.OVL` + 00h instead to view the final scene, followed by the ending
    - Bonus: The final scene transitions to the ending by fading over white. Same with the transition from the intro logo.
      However if you select "オープニング・デモ" ("Opening Demo") on the title screen, it will fade over black.
- Mesuneko Hishoshitsu
  - jump to ending from main menu
    - in `start.mdr` (decrypt by XORing with 0FFh)
      - search for `=neko000.mdr` (should be at the end of the file)
      - overwrite it with `=last.mdr` + a 00 byte
      - then re-encrypt the file
    - select "start from beginning" in the main menu
    - You can also do the search/replace process in the PC-98 emulator's RAM directly while in the main menu. In this case, no decryption is necessary.
- Mirror
  - enable all scenarios
    - open `SAVE.DAT` and set all 2-byte words to `01 00`
- Night Slave
  - reach ending quickly
    - extract `NS_DSK_H.PCK/NSVS0E.MDR` and save it in the game's main folder as `NSVS7S.MDR`
    - extract `NS_DSK_A.PCK/NSSTG7_.CMF` and save copies of the file in the main folder as:
      - `NSEVE1.CMF`
      - `NSEVE2.CMF`
      - `NSSTG0.CMF`
      - `NSSTG0_.CMF`
      - `NSSTG1.CMF`
      - `NSSTG2.CMF`
      - `NSSTG3.CMF`
      - `NSSTG4.CMF`
      - `NSSTG5.CMF`
      - `NSSTG6.CMF`
      - `NSSTG7.CMF`
      - `NSSTG7_.CMF`
      - `NSSTG8.CMF`
      - `NSSTG8B.CMF`
      - `NSSTG9.CMF`
      - `SHIP_E.CMF`
      - `SHIP_P.CMF`
    - after this, you can start the game and will reach the ending after skipping the same short cutscene 17 times
- Oerstedia
  - `SAD.EXE` is used to play back the ingame videos and intro cutscene. (`.CMD` files)  
    It requires `KBDRIVE` (INT D2h) and `MTM` (INT 50h) to be loaded.
    The game uses the following calls in `OERINIT.EXE` (intro) and `OERTERM.EXE` (ending):
    - `SAD.EXE B:FGTTL 0 0` - show FUGA Systems logo
    - `SAD.EXE B:OEROPEN1` - show opening
    - `SAD.EXE B:OEROPEN2 0 0 1 0 0` - show intro cutscene (king audience), parameters
      - parameter 1/2: unknown
      - parameter 3: number of characters to show (`1` = 1 characters, all other values = 2 characters)
      - parameter 4: character 1 type (left side, `0` = fighter, `1` = elf, `2` = dwarf, `3` = lizard, other values = invalid graphics)
      - parameter 5: character 2 type (right side)
    - `SAD.EXE B:OEREND_H 0 0` - show ending and credits
      - The game replaces the last character of the file name with one of the following letters, depending on the player character:
        - `H` - fighter
        - `E` - elf
        - `D` - dwarf
        - `L` - lizard
      - Playing the `OEREND_?` files directly doesn't work, but swapping them with `FGTTL.CMD` works just fine. (aside from the lack of music)
- Pleria - The Royal Emblem
  - jump to ending
    - before booting the game, copy all files from the `_D` folder into the `_B` folder (works around an issue with a missed disk swap command when swapping file names)
    - while in the main menu (file `PL00.SCC` loaded), search for `A:\PL01.SCC` and overwrite it with `A:\PL4401.SCC` + a `00` byte
    - `PL45.SCC` jumps directly to the credits, but won't start the music
- Present 2
  - jump to Game Over screens
    - while in the main menu (file `PR01.SCC` loaded), search for `A:\IN00.SCC` / `A\NE00.SCC` / `A:\MI00.SCC` and replace the `00` with `OV`
    - Note: In case of the scenario "南十字星" / "Southern Cross", you need to enter the scenario's menu screen first (`MI00.SCC`) and then replace `A:\MI01.SCC` with `A:\MIOV.SCC` or the border will have corrupted graphics.
- Rekiai
  - skip "BLucky" logo
    - in `MAINCON.SCE`, search for `83 18 80 00 00 00` and replace it with `83 18 78 00 00 00`
  - enable "Bonus" menu entry
    - in `MAINCON.SCE`, search for `72 20 12 03 00 10 00 00 2F 21 11 6B` and replace the `03` with `04`
  - redirect "Opening" menu entry to the Staff Roll
    - in `MAINCON.SCE`, search for `83 18 E4 00 00 00` and replace it with `83 18 A1 B3 01 00`
    - Note: Offset 0xE4 is where the opening script starts, offset 0x01B3A1 refers to the staff roll.
  - other script offsets:
    - Ending with Shoko: 0x014C60 (use offset 0x014C1E for proper border layout)
    - Ending with Mika: 0x014F88 (use offset 0x00FDE1 for proper background and take the 2nd choice)
    - A recommended method of quickly getting to an ending is to search for `90 11 93 00 00 00` and replace it with `83 18 <offset>`.
      Then just choose "From the beginning" in the main menu.
- Rondo
  - jump to ending from main menu
    - Notes:
      - The actions are to be performed by editing the PC-98 emulator RAM while at a certain location. The script files (`.SO3`) are compressed, so editing them directly is harder.
    - while at the menu selection screen (file `A0_000.SO3`), search for `A:\START.SO3` and overwrite it with `A:\END.SO3` + a `00` byte  
      This will jump directly to the credits screen after confirming the character name.
- Street Mahjong 2
  - [StreetMahjong2_Patches.7z](StreetMahjong2_Patches.7z) contains a partial disassembly + various tiny patches for the main executable
    - `JANTAKU+BOB.EXE` - always trigger "Bob" easter egg cutscene before a match
      - patch: search for `80 3E 22 38 02 75 49`, replace with `80 3E 22 38 02 90 90` (disassembly location `seg002:04F7`, label `loc_1A787`)
      - usually, the cutscene is triggered with a 1/10 chance before playing against the 3rd opponent
    - `JANTAKU+GOVER.EXE` - go to Game Over cutscene instead of starting a match (I couldn't figure out how to lose a match.)
      - patch: search for `83 C4 12 83 7E 06 00`, replace with `83 C4 12 E9 C6 19 00` (disassembly location `seg002:05C0`, before `loc_1A853`)
    - `JANTAKU+ENDING.EXE` - go to Ending instead of starting a match
      - patch: search for `83 C4 12 83 7E 06 00`, replace with `83 C4 12 E9 46 1C 00` (disassembly location `seg002:05C0`, before `loc_1A853`)
- Urban Soldier
  - `.BIN` files are scene scripts and can be decompressed using [kenji_dec](https://github.com/ValleyBell/ExtractorsDecoders/blob/master/kenji_dec.c)
  - jump to various scenes after selecting a player
    - While in the main menu, open the PC-98 emulator's RAM and search for the 2nd occurrence of `A:\US01.BIN`
    - There should be `A:\US13.MF2` a bit above. (**not** `A:\SAVE8.DAT`)
    - change the file and `US01.BIN` one of the following names to access various screens directly:
      - `INIT.BIN` - Initialization
      - `US00.BIN` - Title Screen
      - `US01.BIN` - Map Screen (after player selection)
      - `US01B.BIN` - Match (broken graphics, change needs to be done while at Player Selection screen or the game will crash due to overwriting parts of the script)
      - `US02.BIN`/`US03.BIN`/`US04.BIN` - ?? (loads parts of the match, unuseable without loading data first, eventually redirects to CG scenes, assuming you have won)
      - `US05.BIN` - Continue Screen
      - `US06.BIN` - Staff Roll
- Valkyrie: The Power Beauties
  - Swapping files unfortunately doesn't work here and will cause the game to crash. (probably due to the scripts taking wrong assumptions)
  - Additionally, the scripting language is complex and seems to allow for nested expressions. This makes script hacking difficult.
  - jump to ending scene
    - Take `VA_END.SAV` and put it as `DATA1.SAV` into the game's main folder.
    - Then load the save game.
  - Save game editing hints:
    - Use the [Save Decoder](../z_misc/valkyrie_save-decoder.py) to decrypt the save game, so that it becomes readable.
    - The 2-byte word at offset 0x08 indicates the length of the save's name, which is stored at offset 0x40.
    - At offset `0x40+nameLen`, the script register memory begins.
    - Useful register IDs (file offset = `0x40 + nameLen + registerID*2`)
      - game statistics:
        - register 40 - total damage taken
        - register 41 - total rounds lost
        - register 42 - total continues
      - registers 300..: round statistics
        - 300..304 - round 1, ..., 325..329 - round 6
        - 300/305/... - opponent ID?
        - 301/306/... - damage taken
        - 302/307/... - rounds lost
        - 303/308/... - continues
        - 304/309/... - unused?
- Waku Waku Mahjong Panic! ~Shikigami Denshou~
  - skip intro:
    - while on tht title screen, search for `1500 08 BD0D` and overwrite it with `0A00 E70B 0D` (file `BEGINF.DSD`)
  - jump to scene: (with 3C being the ending scene)
    - while the opening dialogue is scrolling, search for `1700 5E01 0000 62` and replace with `1700 1E02 3C00 62` (file `BEGINF.DSD`)
    - The intro dialogue has to finish in order to avoid graphical glitches.
- Waku Waku Mahjong Panic! 2 ~Kokushi Musou~
  - jump to ending scene
    - Take `WMP2_JAN2FILE.1` and put it as `JAN2FILE.1` into the game's main folder.
    - Then start the game from the beginning. Once you can reach the menu from ingame, load the save game.
    - Loading the save game directly can result in graphical glitches.
    - The "current scene" value is stored in the save file at offset 0x198. It is loaded by various scene files using `1700 9801 xx00` where `xx` can be 00..2F.
